const CELL_SIZE=20,CANVAS_SIZE=500,REDRAW_INTERVAL=50,WIDTH=25,HEIGHT=25,DIRECTION={LEFT:0,RIGHT:1,UP:2,DOWN:3};var MOVE_INTERVAL=[150,110,80,50,30],currentLevel=0;function initPosition(){return{x:Math.floor(25*Math.random()),y:Math.floor(25*Math.random())}}function initHeadAndBody(){let e=initPosition();return{head:e,body:[{x:e.x,y:e.y}]}}function initDirection(){return Math.floor(4*Math.random())}function initSnake(e){return{color:e,...initHeadAndBody(),direction:initDirection(),score:0,lifes:3}}let snake1=initSnake("darkgreen"),apple=[{position:initPosition()},{position:initPosition()},{position:initPosition()}],positionObstcale=[{x:3,y:Math.floor(6.25)},{x:3,y:Math.floor(12.5)},{x:3,y:Math.floor(75/4)},{x:Math.floor(5),y:3},{x:Math.floor(20),y:3}];function drawHorizontal(e,t,o,n,i){e.fillStyle="Black",e.fillRect(20*t,20*o,20*n,20*i)}let hearts={position:initPosition()};function drawCell(e,t,o,n){e.fillStyle=n,e.beginPath(),e.ellipse(20*t+10,20*o+10,8,8,0,0,2*Math.PI),e.fill()}let scores=0,lastScore=0;function drawScore(e){let t=document.getElementById("score1Board"),o=t.getContext("2d");o.clearRect(0,0,500,500),o.font="18px Arial",o.fillStyle=e.color,o.fillText(lastScore+e.score,20,t.scrollHeight/2)}let lifesNow=snake1.lifes;function lifes(e,t,o){let n=document.getElementById("lifes");for(let i=0;i<lifesNow;i++)e.drawImage(n,10+t*i,o,20,20)}function heart(e,t,o){let n=document.getElementById("lifes"),i=snake1.score+lastScore,a=0;for(let e=1;e<=i;e++)i%e==0&&a++;2==a&&snake1.score+lastScore>5&&(e.drawImage(n,20*t,20*o,20,20),console.log(i+" Bilangan prima"))}function draw(){setInterval((function(){let e=document.getElementById("snakeBoard").getContext("2d"),t=document.getElementById("iconApple"),o=document.getElementById("headTopDown"),n=document.getElementById("headLeftRight"),i=document.getElementById("bodySnake");e.clearRect(0,0,500,500),checkLevel(snake1,e),snake1.direction===DIRECTION.LEFT||snake1.direction===DIRECTION.RIGHT?e.drawImage(n,20*snake1.head.x,20*snake1.head.y,20,20):e.drawImage(o,20*snake1.head.x,20*snake1.head.y,20,20);for(let t=1;t<snake1.body.length;t++)e.drawImage(i,20*snake1.body[t].x,20*snake1.body[t].y,20,20);for(let o=0;o<apple.length;o++)e.drawImage(t,20*apple[o].position.x,20*apple[o].position.y,20,20);heart(e,hearts.position.x,hearts.position.y),lifes(e,20,10),drawScore(snake1)}),50)}function teleport(e){e.head.x<0&&(e.head.x=24),e.head.x>=25&&(e.head.x=0),e.head.y<0&&(e.head.y=24),e.head.y>=25&&(e.head.y=0)}function eat(e,t,o){for(let n=0;n<t.length;n++)e.head.x==t[n].position.x&&e.head.y==t[n].position.y?(t[n].position=initPosition(),scores=e.score++,e.body.push({x:e.head.x,y:e.head.y}),document.getElementById("eatApple").play()):e.head.x==o.position.x&&e.head.y==o.position.y&&(o.position=initPosition(),scores=e.score++,lifesNow++,e.body.push({x:e.head.x,y:e.head.y}))}function moveLeft(e){e.head.x--,teleport(e),eat(e,apple,hearts)}function moveRight(e){e.head.x++,teleport(e),eat(e,apple,hearts)}function moveDown(e){e.head.y++,teleport(e),eat(e,apple,hearts)}function moveUp(e){e.head.y--,teleport(e),eat(e,apple,hearts)}function checkCollision(e){let t=!1;for(let o=0;o<e.length;o++){for(let n=0;n<e.length;n++)for(let i=1;i<e[n].body.length;i++)e[o].head.x==e[n].body[i].x&&e[o].head.y==e[n].body[i].y&&(t=!0);let n=0;for(;n<currentLevel&&currentLevel<=3;)e[o].head.x>=positionObstcale[n].x&&e[o].head.x<=positionObstcale[n].x+19&&e[o].head.y==positionObstcale[n].y&&(t=!0),n++;4==currentLevel&&(e[o].head.y>=positionObstcale[3].y&&e[o].head.y<=positionObstcale[3].y+19&&e[o].head.x==positionObstcale[3].x||e[o].head.y>=positionObstcale[4].y&&e[o].head.y<=positionObstcale[4].y+19&&e[o].head.x==positionObstcale[4].x)&&(t=!0)}return t&&(snake1=initSnake("green"),lifesNow-=1,lastScore=lastScore+scores+1,console.log("current "+lastScore),lifesNow<1&&(document.getElementById("gameover").play(),alert("Game Over"),lifesNow=3,lastScore=0)),t}function move(e){switch(e.direction){case DIRECTION.LEFT:moveLeft(e);break;case DIRECTION.RIGHT:moveRight(e);break;case DIRECTION.DOWN:moveDown(e);break;case DIRECTION.UP:moveUp(e)}moveBody(e),checkCollision([snake1])?initGame():setTimeout((function(){move(e)}),MOVE_INTERVAL[currentLevel])}function moveBody(e){e.body.unshift({x:e.head.x,y:e.head.y}),e.body.pop()}function turn(e,t){t!=={[DIRECTION.LEFT]:DIRECTION.RIGHT,[DIRECTION.RIGHT]:DIRECTION.LEFT,[DIRECTION.DOWN]:DIRECTION.UP,[DIRECTION.UP]:DIRECTION.DOWN}[e.direction]&&(e.direction=t)}let levelUp=!0;function checkLevel(e,t){let o=document.getElementById("leveling");lastScore+e.score<=5?(o.textContent="1",currentLevel=0):lastScore+e.score<=10?(o.textContent="2",drawHorizontal(t,positionObstcale[0].x,positionObstcale[0].y,20,1),currentLevel=1,levelUp&&(document.getElementById("levelUp").play(),levelUp=!1)):lastScore+e.score<=15?(o.textContent="3",drawHorizontal(t,positionObstcale[0].x,positionObstcale[0].y,20,1),drawHorizontal(t,positionObstcale[1].x,positionObstcale[1].y,20,1),currentLevel=2,levelUp||(document.getElementById("levelUp").play(),levelUp=!0)):lastScore+e.score<=20?(o.textContent="4",drawHorizontal(t,positionObstcale[0].x,positionObstcale[0].y,20,1),drawHorizontal(t,positionObstcale[1].x,positionObstcale[1].y,20,1),drawHorizontal(t,positionObstcale[2].x,positionObstcale[2].y,20,1),currentLevel=3,levelUp&&(document.getElementById("levelUp").play(),levelUp=!1)):(o.textContent="5",drawHorizontal(t,positionObstcale[3].x,positionObstcale[3].y,1,20),drawHorizontal(t,positionObstcale[4].x,positionObstcale[4].y,1,20),currentLevel=4,levelUp||(document.getElementById("levelUp").play(),levelUp=!0))}function initGame(){move(snake1)}document.addEventListener("keydown",(function(e){"ArrowLeft"===e.key?turn(snake1,DIRECTION.LEFT):"ArrowRight"===e.key?turn(snake1,DIRECTION.RIGHT):"ArrowUp"===e.key?turn(snake1,DIRECTION.UP):"ArrowDown"===e.key&&turn(snake1,DIRECTION.DOWN)})),initGame();
